(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.registerHelper("fold","brace",function(r,n){var t=n.line,i=r.getLine(t);var o,f;function l(o){for(var l=n.ch,s=0;;){var u=l<=0?-1:i.lastIndexOf(o,l-1);if(u==-1){if(s==1)break;s=1;l=i.length;continue}if(s==1&&u<n.ch)break;f=r.getTokenTypeAt(e.Pos(t,u+1));if(!/^(comment|string)/.test(f))return u+1;l=u-1}}var s="{",u="}",o=l("{");if(o==null){s="[",u="]";o=l("[")}if(o==null)return;var a=1,d=r.lastLine(),c,g;e:for(var v=t;v<=d;++v){var p=r.getLine(v),m=v==t?o:0;for(;;){var P=p.indexOf(s,m),k=p.indexOf(u,m);if(P<0)P=p.length;if(k<0)k=p.length;m=Math.min(P,k);if(m==p.length)break;if(r.getTokenTypeAt(e.Pos(v,m+1))==f){if(m==P)++a;else if(!--a){c=v;g=m;break e}}++m}}if(c==null||t==c&&g==o)return;return{from:e.Pos(t,o),to:e.Pos(c,g)}});e.registerHelper("fold","import",function(r,n){function t(n){if(n<r.firstLine()||n>r.lastLine())return null;var t=r.getTokenAt(e.Pos(n,1));if(!/\S/.test(t.string))t=r.getTokenAt(e.Pos(n,t.end+1));if(t.type!="keyword"||t.string!="import")return null;for(var i=n,o=Math.min(r.lastLine(),n+10);i<=o;++i){var f=r.getLine(i),l=f.indexOf(";");if(l!=-1)return{startCh:t.end,end:e.Pos(i,l)}}}var n=n.line,i=t(n),o;if(!i||t(n-1)||(o=t(n-2))&&o.end.line==n-1)return null;for(var f=i.end;;){var l=t(f.line+1);if(l==null)break;f=l.end}return{from:r.clipPos(e.Pos(n,i.startCh+1)),to:f}});e.registerHelper("fold","include",function(r,n){function t(n){if(n<r.firstLine()||n>r.lastLine())return null;var t=r.getTokenAt(e.Pos(n,1));if(!/\S/.test(t.string))t=r.getTokenAt(e.Pos(n,t.end+1));if(t.type=="meta"&&t.string.slice(0,8)=="#include")return t.start+8}var n=n.line,i=t(n);if(i==null||t(n-1)!=null)return null;for(var o=n;;){var f=t(o+1);if(f==null)break;++o}return{from:e.Pos(n,i+1),to:r.clipPos(e.Pos(o))}})});