(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";var t="CodeMirror-activeline";var i="CodeMirror-activeline-background";e.defineOption("styleActiveLine",false,function(t,i,r){var s=r&&r!=e.Init;if(i&&!s){t.state.activeLines=[];a(t,t.listSelections());t.on("beforeSelectionChange",o)}else if(!i&&s){t.off("beforeSelectionChange",o);n(t);delete t.state.activeLines}});function n(e){for(var n=0;n<e.state.activeLines.length;n++){e.removeLineClass(e.state.activeLines[n],"wrap",t);e.removeLineClass(e.state.activeLines[n],"background",i)}}function r(e,t){if(e.length!=t.length)return false;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return false;return true}function a(e,a){var o=[];for(var s=0;s<a.length;s++){var f=a[s];if(!f.empty())continue;var c=e.getLineHandleVisualStart(f.head.line);if(o[o.length-1]!=c)o.push(c)}if(r(e.state.activeLines,o))return;e.operation(function(){n(e);for(var r=0;r<o.length;r++){e.addLineClass(o[r],"wrap",t);e.addLineClass(o[r],"background",i)}e.state.activeLines=o})}function o(e,t){a(e,t.ranges)}});