(function(t){if(typeof exports=="object"&&typeof module=="object")t(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],t);else t(CodeMirror)})(function(t){"use strict";var e=2;var i="matchhighlight";var r=100;function o(t){if(typeof t=="object"){this.minChars=t.minChars;this.style=t.style;this.showToken=t.showToken;this.delay=t.delay}if(this.style==null)this.style=i;if(this.minChars==null)this.minChars=e;if(this.delay==null)this.delay=r;this.overlay=this.timeout=null}t.defineOption("highlightSelectionMatches",false,function(e,i,r){if(r&&r!=t.Init){var a=e.state.matchHighlighter.overlay;if(a)e.removeOverlay(a);clearTimeout(e.state.matchHighlighter.timeout);e.state.matchHighlighter=null;e.off("cursorActivity",n)}if(i){e.state.matchHighlighter=new o(i);s(e);e.on("cursorActivity",n)}});function n(t){var e=t.state.matchHighlighter;clearTimeout(e.timeout);e.timeout=setTimeout(function(){s(t)},e.delay)}function s(t){t.operation(function(){var e=t.state.matchHighlighter;if(e.overlay){t.removeOverlay(e.overlay);e.overlay=null}if(!t.somethingSelected()&&e.showToken){var i=e.showToken===true?/[\w$]/:e.showToken;var r=t.getCursor(),o=t.getLine(r.line),n=r.ch,s=n;while(n&&i.test(o.charAt(n-1)))--n;while(s<o.length&&i.test(o.charAt(s)))++s;if(n<s)t.addOverlay(e.overlay=l(o.slice(n,s),i,e.style));return}var a=t.getCursor("from"),h=t.getCursor("to");if(a.line!=h.line)return;var c=t.getRange(a,h).replace(/^\s+|\s+$/g,"");if(c.length>=e.minChars)t.addOverlay(e.overlay=l(c,false,e.style))})}function a(t,e){return(!t.start||!e.test(t.string.charAt(t.start-1)))&&(t.pos==t.string.length||!e.test(t.string.charAt(t.pos)))}function l(t,e,i){return{token:function(r){if(r.match(t)&&(!e||a(r,e)))return i;r.next();r.skipTo(t.charAt(0))||r.skipToEnd()}}}});